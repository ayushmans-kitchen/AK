{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Master Admin | Bento Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Playfair+Display:wght@700;900&display=swap" rel="stylesheet">

    <style>
        :root {
            --gold: #d4af37;
            --bg-deep: #050505;
            --bg-card: #0c0c0c;
            --border: #1a1a1a;
            --text-muted: #d6d6d6;
            --sb-width: 260px;
            --transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* --- BASE --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Montserrat', sans-serif; background-color: var(--bg-deep); color: #fff; -webkit-font-smoothing: antialiased; overflow-x: hidden; }

        /* --- MOBILE NAV LOGIC --- */
        .nav-toggle { display: none; }
        .mobile-header {
            display: none; position: fixed; top: 0; width: 100%; height: 60px;
            background: #000; padding: 0 1.5rem; align-items: center; justify-content: space-between;
            z-index: 2100; border-bottom: 1px solid var(--border);
        }
        .hamburger { width: 25px; height: 16px; display: flex; flex-direction: column; justify-content: space-between; cursor: pointer; }
        .hamburger span { height: 2px; width: 100%; background: var(--gold); border-radius: 10px; transition: var(--transition); }

        /* --- SIDEBAR --- */
        .sidebar {
            width: var(--sb-width); height: 100vh; position: fixed; left: 0; top: 0;
            background: #000; border-right: 1px solid var(--border); display: flex; flex-direction: column;
            padding: 2rem 1.2rem; z-index: 2000; transition: var(--transition);
        }
        .sidebar-logo { font-family: 'Playfair Display', serif; font-size: 1.3rem; font-weight: 900; margin-bottom: 3rem; color: #fff; }
        .nav-links { list-style: none; flex-grow: 1; }
        .nav-item { display: flex; align-items: center; padding: 10px 14px; margin-bottom: 5px; color: #555; text-decoration: none; border-radius: 6px; font-size: 0.8rem; transition: 0.2s; }
        .nav-item.active { background: var(--gold); color: #000; font-weight: 700; }
        .nav-item:hover:not(.active) { color: #fff; background: #111; }

        /* --- MAIN CONTENT --- */
        .main-content { margin-left: var(--sb-width); padding: 1.5rem 2rem; transition: var(--transition); }
        .top-bar { margin-bottom: 1.5rem; border-bottom: 1px solid var(--border); padding-bottom: 1rem; }
        .top-bar h1 { font-family: 'Playfair Display'; font-size: 1.4rem; color: var(--gold); }
        .top-bar p { color: var(--text-muted); font-size: 0.7rem; }

        /* --- BENTO STATS GRID --- */
        .bento-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 2rem; }
        
        /* Bento Link Wrapper Reset */
        .bento-grid a { text-decoration: none; color: inherit; display: block; transition: transform 0.2s ease; }
        .bento-grid a:hover { transform: translateY(-3px); }

        .bento-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: 6px; padding: 1rem; display: flex; flex-direction: column; justify-content: center; height: 100%; }
        
        .featured-card { grid-column: span 2; border-left: 3px solid var(--gold); background: linear-gradient(to right, #0f0f0f, #0c0c0c); }
        .group-title { grid-column: span 4; font-size: 0.65rem; text-transform: uppercase; letter-spacing: 2px; color: var(--gold); margin-top: 0.5rem; padding-bottom: 5px; border-bottom: 1px solid var(--border); }

        .stat-label { font-size: 0.6rem; text-transform: uppercase; color: var(--text-muted); letter-spacing: 0.5px; margin-bottom: 4px; }
        .stat-value { font-size: 1.3rem; font-weight: 700; }
        .featured-card .stat-value { font-size: 2rem; color: var(--gold); }

        /* --- BUTTONS --- */
        .bento-btn {
            background: transparent;
            border: 1px solid var(--gold);
            color: var(--gold);
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 0.65rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: var(--transition);
            width: fit-content;
            margin-top: 5px;
        }

        .bento-btn:hover {
            background: var(--gold);
            color: #000;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.3);
        }

        /* --- DASHBOARD LAYOUT --- */
        .dashboard-layout { display: flex; gap: 1.5rem; align-items: stretch; }
        .left-col { flex: 1.6; display: flex; flex-direction: column; gap: 1.5rem; }
        .right-col { flex: 1; display: flex; flex-direction: column; gap: 1.5rem; }

        .card { background: var(--bg-card); border: 1px solid var(--border); border-radius: 6px; padding: 1.2rem; display: flex; flex-direction: column; }
        .left-col .card:last-child, .right-col .card:last-child { flex-grow: 1; }

        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
        .card-header h3 { font-size: 0.75rem; color: var(--gold); text-transform: uppercase; letter-spacing: 1px; }

        .row { display: flex; justify-content: space-between; padding: 0.65rem 0; border-bottom: 1px solid #141414; font-size: 0.75rem; }
        .row:last-child { border-bottom: none; }
        .qty { color: var(--gold); font-weight: 700; }

        .scroll-container { overflow-y: auto; padding-right: 8px; }
        .alert-area { height: 180px; }
        .chat-area { height: 180px; flex-grow: 1; }
        .scroll-container::-webkit-scrollbar { width: 3px; }
        .scroll-container::-webkit-scrollbar-thumb { background: #222; }

        .alert-item { background: #0a0a0a; border: 1px solid #1a1a1a; padding: 0.7rem; border-radius: 4px; margin-bottom: 0.5rem; display: flex; justify-content: space-between; align-items: center; }
        .alert-info h4 { font-size: 0.75rem; }
        .alert-info p { font-size: 0.65rem; color: var(--text-muted); }
        .badge-danger { color: #ff4444; font-size: 0.65rem; font-weight: 700; }

        .chat-msg { margin-bottom: 1rem; padding: 8px; background: rgba(255,255,255,0.01); border-radius: 4px; border-left: 2px solid #222; }
        .chat-msg.admin { border-left-color: var(--gold); }
        .chat-meta { display: flex; justify-content: space-between; font-size: 0.6rem; margin-bottom: 4px; color: var(--text-muted); }
        .delete-btn { background: none; border: none; color: #444; cursor: pointer; font-size: 0.6rem; text-transform: uppercase; font-weight: 600; }

        .input-group { display: flex; gap: 8px; border-top: 1px solid var(--border); padding-top: 1rem; margin-top: auto; }
        .input-group input { flex: 1; background: #111; border: 1px solid var(--border); padding: 8px; border-radius: 4px; color: #fff; font-size: 0.75rem; outline: none; }
        .send-btn { background: var(--gold); border: none; padding: 0 12px; border-radius: 4px; font-weight: 700; font-size: 0.7rem; cursor: pointer; }

        /* --- RESPONSIVE --- */
        @media (max-width: 1024px) {
            .mobile-header { display: flex; }
            .sidebar { transform: translateX(-100%); padding-top: 5rem; }
            .main-content { margin-left: 0; padding: 5rem 1rem 1rem 1rem; }
            .nav-toggle:checked ~ .sidebar { transform: translateX(0); }
            .nav-toggle:checked ~ .mobile-header .hamburger span:nth-child(1) { transform: translateY(7.5px) rotate(45deg); }
            .nav-toggle:checked ~ .mobile-header .hamburger span:nth-child(2) { opacity: 0; }
            .nav-toggle:checked ~ .mobile-header .hamburger span:nth-child(3) { transform: translateY(-8.5px) rotate(-45deg); }
            .bento-grid { grid-template-columns: repeat(2, 1fr); }
            .group-title { grid-column: span 2; }
            .dashboard-layout { flex-direction: column; }
        }

        @media (max-width: 600px) {
            .bento-grid { grid-template-columns: 1fr; }
            .group-title { grid-column: span 1; }
            .featured-card { grid-column: span 1; }
        }
    </style>
</head>
<body>

    <input type="checkbox" id="nav-toggle" class="nav-toggle">

    {% include "Admin/sidebar.html" %}

    <main class="main-content">
        <header class="top-bar">
            <h1>SERVICE DASHBOARD</h1>
            <p> {% now "l d F Y" %}</p>
        </header>

        <div class="bento-grid">
            <div class="bento-card featured-card">
                <span class="stat-label">Total Customers</span>
                <div class="stat-value">{{total_customers}}</div>
            </div>
            <div class="bento-card">
                <span class="stat-label">Inactive Customers</span>
                <div class="stat-value">{{total_inactive_customers}}</div>
            </div>
            <div class="bento-card">
                <span class="stat-label">Plan Ended</span>
                <div class="stat-value" style="color:#ff4444">{{total_plan_end_customers}}</div>
            </div>

            <div class="group-title">Lunch Service</div>
            
            <a href="{% url 'service_details' %}">
                <div class="bento-card"><span class="stat-label">Dine-In</span><div class="stat-value">{{lunch_dinein}}</div></div>
            </a>
            <a href="{% url 'service_details' %}">
                <div class="bento-card"><span class="stat-label">Deliveries</span><div class="stat-value">{{lunch_delivery}}</div></div>
            </a>
            <a href="{% url 'service_details' service='PickUp' dayTime='Lunch' %}">
                <div class="bento-card"><span class="stat-label">Pick-Up</span><div class="stat-value">{{lunch_pickup}}</div></div>
            </a>
            <a href="{% url 'service_details' %}">
                <div class="bento-card" style="background:rgba(212,175,55,0.05)">
                    <span class="stat-label">Total Lunch</span>
                    <div class="stat-value" style="color:var(--gold)">{{total_lunch}}</div>
                </div>
            </a>
            <a href="{% url 'service_details' %}">
                <div class="bento-card"><span class="stat-label">Cancelled</span><div class="stat-value">{{lunch_cancelled}}</div></div>
            </a>

            <div class="bento-card"><span class="stat-label">Inactive</span><div class="stat-value">{{lunch_inactive}}</div></div>
            <div class="bento-card"><span class="stat-label">Default Entries</span><div class="stat-value">{{lunch_default_need}}</div></div>
            <div class="bento-card">
                <span class="stat-label">Generate Lunch Record</span>
                <button class="bento-btn"><a href="{% url 'gen_Lunch_record' %}" style="transform:none;">Generate</a></button>
            </div>

            <div class="group-title">Dinner Service</div>

            <a href="{% url 'service_details' %}">
                <div class="bento-card"><span class="stat-label">Dine-In</span><div class="stat-value">{{dinner_dinein}}</div></div>
            </a>
            <a href="{% url 'service_details' %}">
                <div class="bento-card"><span class="stat-label">Deliveries</span><div class="stat-value">{{dinner_delivery}}</div></div>
            </a>
            <a href="{% url 'service_details' %}">
                <div class="bento-card"><span class="stat-label">Pick-Up</span><div class="stat-value">{{dinner_pickup}}</div></div>
            </a>
            <a href="{% url 'service_details' %}">
                <div class="bento-card" style="background:rgba(212,175,55,0.05)">
                    <span class="stat-label">Total Dinner</span>
                    <div class="stat-value" style="color:var(--gold)">{{total_dinner}}</div>
                </div>
            </a>
            <a href="{% url 'service_details' %}">
                <div class="bento-card"><span class="stat-label">Cancelled</span><div class="stat-value">{{dinner_cancelled}}</div></div>
            </a>

            <div class="bento-card"><span class="stat-label">Inactive</span><div class="stat-value">{{dinner_inactive}}</div></div>
            <div class="bento-card"><span class="stat-label">Default Entries</span><div class="stat-value">{{dinner_default_need}}</div></div>
            <div class="bento-card">
                <span class="stat-label">Generate Dinner Record</span>
                <button class="bento-btn"><a href="{% url 'gen_Dinner_record' %}" style="transform:none;">Generate</a></button>
                
            </div>
        </div>

        <div class="dashboard-layout">
            <div class="left-col">
                <div class="card">
                    <div class="card-header"><h3>Lunch Kitchen Prep</h3></div>
                    <div class="row"><span>VEG</span><span class="qty">{{ l_food.VEG }}</span></div>
                    <div class="row"><span>NON VEG</span><span class="qty">{{ l_food.NON_VEG }}</span></div>
                    <div class="row"><span>PANEER</span><span class="qty">{{ l_food.PANEER }}</span></div>
                    <div class="row"><span>MUSHROOM</span><span class="qty">{{ l_food.MUSHROOM }}</span></div>
                    <div class="row"><span>CHICKEN</span><span class="qty">{{ l_food.CHICKEN }}</span></div>
                    <div class="row"><span>EGG</span><span class="qty">{{ l_food.EGG }}</span></div>
                    <div class="row"><span>PRAWN</span><span class="qty">{{ l_food.PRAWN }}</span></div>
                    <div class="row"><span>FISH</span><span class="qty">{{ l_food.FISH }}</span></div>
                </div>

                <div class="card">
                    <div class="card-header"><h3>Dinner Kitchen Prep</h3></div>
                    <div class="row"><span>VEG</span><span class="qty">{{ d_food.VEG }}</span></div>
                    <div class="row"><span>NON VEG</span><span class="qty">{{ d_food.NON_VEG }}</span></div>
                    <div class="row"><span>PANEER</span><span class="qty">{{ d_food.PANEER }}</span></div>
                    <div class="row"><span>MUSHROOM</span><span class="qty">{{ d_food.MUSHROOM }}</span></div>
                    <div class="row"><span>CHICKEN</span><span class="qty">{{ d_food.CHICKEN }}</span></div>
                    <div class="row"><span>EGG</span><span class="qty">{{ d_food.EGG }}</span></div>
                </div>
            </div>

            <div class="right-col">
                <div class="card">
                    <div class="card-header"><h3>Low Meals Alert</h3></div>
                    <div class="scroll-container alert-area">
                        {% for c in low_balance_customer %}
                        <div class="alert-item">
                            <div class="alert-info"><h4>{{c.name}}</h4><p>{{c.phone}}</p></div>
                            <span class="badge-danger">{{c.meal_balance}} Left</span>
                        </div>
                        {% endfor %}
                    </div>
                </div>

                <div class="card">
                    <div class="card-header"><h3>Broadcast Message</h3></div>
                    <div class="scroll-container chat-area">
                        {% for m in admin_messgaes %}
                        <form method='POST' action="{% url 'admin_notice_delete' mid=m.pk %}">
                            {% csrf_token %}
                            <div class="chat-msg admin">
                                <div class="chat-meta"><span>{{m.date}}</span><button class="delete-btn">Delete</button></div>
                                <p class="chat-text">{{m.message}}</p>
                            </div>
                        </form>
                        {% endfor %}
                    </div>
                    <form method='POST' action="{% url 'admin_notice' %}">
                        {% csrf_token %}
                        <div class="input-group"> 
                            <input type="text" placeholder="Message all..." name="message">
                            <button class="send-btn">SEND</button>
                        </div>
                    </form>    
                </div>
            </div>
        </div>
    </main>
</body>
</html>