{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subscribers | Ayushman's Kitchen</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Playfair+Display:wght@700;900&display=swap"
        rel="stylesheet">

<style>
:root {
    --gold: #d4af37;
    --gold-glow: rgba(212, 175, 55, 0.2);
    --bg-deep: #050505;
    --bg-card: #0c0c0c;
    --border: #1a1a1a;
    --text-muted: #888888;
    --sb-width: 260px;
    --transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

/* --- BASE & RESET --- */
* { 
    margin: 0; 
    padding: 0; 
    box-sizing: border-box; 
}

body { 
    font-family: 'Montserrat', sans-serif; 
    background-color: var(--bg-deep); 
    color: #fff; 
    -webkit-font-smoothing: antialiased; 
    overflow-x: hidden; 
}

/* --- MOBILE HEADER --- */
.nav-toggle { display: none; }

.mobile-header {
    display: none; 
    position: fixed; 
    top: 0; 
    width: 100%; 
    height: 60px;
    background: #000; 
    padding: 0 1.5rem; 
    align-items: center; 
    justify-content: space-between;
    z-index: 2100; 
    border-bottom: 1px solid var(--border);
}

.hamburger { 
    width: 25px; 
    height: 16px; 
    display: flex; 
    flex-direction: column; 
    justify-content: space-between; 
    cursor: pointer; 
}

.hamburger span { 
    height: 2px; 
    width: 100%; 
    background: var(--gold); 
    border-radius: 10px; 
    transition: var(--transition); 
}

/* --- MAIN CONTENT --- */
.main-content { 
    margin-left: var(--sb-width); 
    padding: 1.5rem 2.5rem; /* Reduced from 3rem */
    transition: var(--transition); 
    min-height: 100vh; 
}

/* --- COMPACT HEADER SECTION --- */
.page-header { 
    display: flex; 
    justify-content: space-between; 
    align-items: center; 
    margin-bottom: 1.5rem; 
    border-bottom: 1px solid var(--border); 
    padding-bottom: 1rem; 
    gap: 1.5rem; 
}

.header-info h1 { 
    font-family: 'Playfair Display', serif; 
    font-size: 1.4rem; /* Scaled down for professional dashboard feel */
    color: var(--gold); 
    letter-spacing: -0.5px; 
    text-transform: uppercase;
    font-weight: 800;
}

.header-info p { 
    color: var(--text-muted); 
    font-size: 0.75rem; 
    margin-top: 2px; 
    font-weight: 600; 
    letter-spacing: 0.5px;
}

.header-actions { 
    display: flex; 
    align-items: center; 
    gap: 1rem; 
}

/* --- SEARCH BAR --- */
.search-wrapper input {
    width: 300px; 
    background: #0a0a0a; 
    border: 1px solid var(--border); 
    padding: 0.65rem 1.2rem;
    border-radius: 8px; 
    color: white; 
    font-size: 0.85rem; 
    outline: none; 
    transition: var(--transition);
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.5);
}

.search-wrapper input:focus { 
    border-color: var(--gold); 
    background: #111; 
    box-shadow: 0 0 15px var(--gold-glow); 
}

/* --- ADD BUTTON --- */
.btn-add {
    background: var(--gold); 
    color: #000; 
    padding: 0.65rem 1.2rem; 
    border-radius: 8px;
    font-size: 0.7rem; 
    font-weight: 800; 
    text-decoration: none; 
    text-transform: uppercase;
    letter-spacing: 1px; 
    transition: 0.3s; 
    display: inline-flex; 
    align-items: center; 
    gap: 8px;
}

.btn-add:hover { 
    transform: translateY(-2px); 
    box-shadow: 0 5px 15px var(--gold-glow); 
    opacity: 0.9;
}

/* --- SUBSCRIBER GRID --- */
.subscriber-grid { 
    display: grid; 
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); 
    gap: 1.25rem; 
}

/* --- TIER CARDS --- */
.tier-card {
    background: var(--bg-card); 
    border: 1px solid var(--border); 
    border-radius: 12px;
    padding: 1.5rem; 
    display: flex; 
    flex-direction: column; 
    height: 450px; /* Slightly tighter height */
    transition: var(--transition);
    position: relative;
    overflow: hidden;
}

.tier-card.flagship { 
    border-color: rgba(212, 175, 55, 0.3); 
    background: linear-gradient(145deg, #0d0d0d, #050505);
}

.card-header { 
    display: flex; 
    justify-content: space-between; 
    align-items: flex-start; 
    margin-bottom: 1.25rem; 
}

.tier-label h3 { 
    font-size: 0.65rem; 
    text-transform: uppercase; 
    letter-spacing: 1.5px; 
    color: var(--gold); 
    margin-bottom: 4px; 
}

.tier-label span { 
    font-size: 1.8rem; 
    font-weight: 900; 
    color: #fff; 
    line-height: 1; 
}

.tier-label p { 
    font-size: 0.7rem; 
    color: var(--text-muted); 
    font-weight: 600; 
}

.badge { 
    background: rgba(255,255,255,0.05); 
    color: #fff; 
    padding: 4px 10px; 
    border-radius: 6px; 
    font-size: 0.6rem; 
    font-weight: 800; 
    border: 1px solid var(--border); 
}

.badge.gold { 
    color: var(--gold); 
    border-color: var(--gold); 
    background: var(--gold-glow); 
}

/* --- USER LIST --- */
.user-list { 
    flex: 1; 
    overflow-y: auto; 
    padding-right: 5px; 
    margin-top: 0.5rem; 
}

.user-list::-webkit-scrollbar { width: 3px; }
.user-list::-webkit-scrollbar-thumb { background: #222; border-radius: 10px; }

.user-row {
    display: flex; 
    align-items: center; 
    justify-content: space-between;
    padding: 10px 12px; 
    background: rgba(255,255,255,0.02); 
    border: 1px solid var(--border);
    border-radius: 10px; 
    margin-bottom: 8px; 
    text-decoration: none; 
    transition: 0.2s ease;
}

.user-row:hover { 
    background: rgba(212, 175, 55, 0.05); 
    border-color: rgba(212, 175, 55, 0.2); 
    transform: translateX(4px);
}

.user-content { 
    display: flex; 
    align-items: center; 
    gap: 12px; 
}

.avatar { 
    width: 32px; 
    height: 32px; 
    background: #111; 
    border-radius: 50%; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    color: var(--gold); 
    font-size: 0.9rem; 
    border: 1px solid var(--border); 
}

.flagship .avatar { 
    background: var(--gold); 
    color: #000; 
}

.user-details h4 { 
    font-size: 0.85rem; 
    color: #fff; 
    font-weight: 600; 
}

.user-details p { 
    font-size: 0.65rem; 
    color: var(--text-muted); 
}

.arrow { 
    color: #333; 
    font-size: 1rem; 
}

/* --- RESPONSIVE LOGIC --- */
@media (max-width: 1024px) {
    .mobile-header { display: flex; height: 60px; }
    .sidebar { transform: translateX(-100%); }
    
    .main-content { 
        margin-left: 0; 
        padding: 5rem 1rem 2rem 1rem; 
    }

    .nav-toggle:checked ~ .sidebar { transform: translateX(0); }

    .page-header { 
        flex-direction: column; 
        align-items: flex-start; 
        gap: 1rem; 
    }

    .header-info h1 { font-size: 1.2rem; }

    .header-actions { 
        width: 100%; 
        flex-direction: column; 
        gap: 0.75rem; 
    }

    .search-wrapper, .search-wrapper input { width: 100%; }
    .btn-add { width: 100%; justify-content: center; }
    
    .subscriber-grid {
        grid-template-columns: 1fr; /* Stack cards on mobile */
    }
}
.back-link {
    color: #d4af37; /* Gold theme color */
    text-decoration: none;
    font-size: 0.6rem; /* Small, compact size */
    text-transform: uppercase;
    font-weight: 800; /* Bold for professional feel */
    letter-spacing: 1.5px;
    display: inline-block;
    margin-bottom: 5px;
    transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    font-family: 'Montserrat', sans-serif;
    cursor: pointer;
}

/* Hover interaction */
.back-link:hover {
    opacity: 0.7;
    transform: translateX(-3px); /* Subtle shift effect */
}
</style>
</head>

<body>

    <input type="checkbox" id="nav-toggle" class="nav-toggle">

    <header class="mobile-header">
        <div class="logo"
            style="font-family: 'Playfair Display'; color: var(--gold); font-weight: 900; font-size: 1rem;">AK ADMIN
        </div>
        <label for="nav-toggle" class="hamburger">
            <span></span><span></span><span></span>
        </label>
    </header>

    {% include "Admin/sidebar.html" %}

    <main class="main-content">
        <div class="page-header">
            <div class="header-info">
                <a href="{% url 'ayushman_dashboard' %}" class="back-link">‚Üê Back to Dashboard</a>
                <h1>SUBSCRIBERS</h1>
                <p>Manage user tiers and meal credits</p>
            </div>
            <div class="header-actions">
                <div class="search-wrapper">
                    <input type="text" id="subscriberSearch" placeholder="Search subscribers...">
                </div>
                <a href="{% url 'add_customer'%}" class="btn-add"><span>+</span> Add Customer</a>
            </div>
        </div>

        <div class="subscriber-grid">

            <div class="tier-card">
                <div class="card-header">
                    <div class="tier-label">
                        <h3>Normal 30</h3>
                        <span>{{N30|length}}</span>
                         
                    </div>
                    <span class="badge">Rs. 1500</span>
                </div>
                <div class="user-list">
                    {% for c in N30 %}
                    <a href="{% url 'customer_profile' c.id %}" class="user-row">
                        <div class="user-content">
                            <div class="avatar">üë§</div>
                            <div class="user-details">
                                <h4>{{c.name}}</h4>
                                <p>{{c.phone}} ‚Ä¢ {{c.meal_balance}} Left</p>
                            </div>
                        </div>
                        <span class="arrow">‚Ä∫</span>
                    </a>
                    {% endfor %}
                </div>
            </div>

            <div class="tier-card">
                <div class="card-header">
                    <div class="tier-label">
                        <h3>Normal 60</h3>
                        <span>{{N60|length}}</span>
                         
                    </div>
                    <span class="badge">Rs. 3000</span>
                </div>
                <div class="user-list">
                    {% for c in N60 %}
                    <a href="{% url 'customer_profile' c.id %}" class="user-row">
                        <div class="user-content">
                            <div class="avatar">üë§</div>
                            <div class="user-details">
                                <h4>{{c.name}}</h4>
                                <p>{{c.phone}} ‚Ä¢ {{c.meal_balance}} Left</p>
                            </div>
                        </div>
                        <span class="arrow">‚Ä∫</span>
                    </a>
                    {% endfor %}
                </div>
            </div>

            <div class="tier-card flagship">
                <div class="card-header">
                    <div class="tier-label">
                        <h3>Flagship 30</h3>
                        <span style="color: var(--gold)">{{F30|length}}</span>
                         
                    </div>
                    <span class="badge gold">Rs. 1800</span>
                </div>
                <div class="user-list">
                    {% for c in F30 %}
                    <a href="{% url 'customer_profile' c.id %}" class="user-row">
                        <div class="user-content">
                            <div class="avatar">‚òÖ</div>
                            <div class="user-details">
                                <h4>{{c.name}}</h4>
                                <p>{{c.phone}} ‚Ä¢ {{c.meal_balance}} Left</p>
                            </div>
                        </div>
                        <span class="arrow">‚Ä∫</span>
                    </a>
                    {% endfor %}
                </div>
            </div>

            <div class="tier-card flagship">
                <div class="card-header">
                    <div class="tier-label">
                        <h3>Flagship 60</h3>
                        <span style="color: var(--gold)">{{F60|length}}</span>
                         
                    </div>
                    <span class="badge gold">Rs. 3400</span>
                </div>
                <div class="user-list">
                    {% for c in F60 %}
                    <a href="{% url 'customer_profile' c.id %}" class="user-row">
                        <div class="user-content">
                            <div class="avatar">‚òÖ</div>
                            <div class="user-details">
                                <h4>{{c.name}}</h4>
                                <p>{{c.phone}} ‚Ä¢ {{c.meal_balance}} Left</p>
                            </div>
                        </div>
                        <span class="arrow">‚Ä∫</span>
                    </a>
                    {% endfor %}
                </div>
            </div>
            <div class="tier-card flagship">
                <div class="card-header">
                    <div class="tier-label">
                        <h3>Premium 30</h3>
                        <span style="color: var(--gold)">{{P30|length}}</span>
                         
                    </div>
                    <span class="badge gold">Rs. 2200</span>
                </div>
                <div class="user-list">
                    {% for c in P30 %}
                    <a href="{% url 'customer_profile' c.id %}" class="user-row">
                        <div class="user-content">
                            <div class="avatar">‚òÖ‚òÖ</div>
                            <div class="user-details">
                                <h4>{{c.name}}</h4>
                                <p>{{c.phone}} ‚Ä¢ {{c.meal_balance}} Left</p>
                            </div>
                        </div>
                        <span class="arrow">‚Ä∫</span>
                    </a>
                    {% endfor %}
                </div>
            </div>
            <div class="tier-card flagship">
                <div class="card-header">
                    <div class="tier-label">
                        <h3>Premium 60</h3>
                        <span style="color: var(--gold)">{{P60|length}}</span>
                         
                    </div>
                    <span class="badge gold">Rs. 4200</span>
                </div>
                <div class="user-list">
                    {% for c in P60 %}
                    <a href="{% url 'customer_profile' c.id %}" class="user-row">
                        <div class="user-content">
                            <div class="avatar">‚òÖ‚òÖ</div>
                            <div class="user-details">
                                <h4>{{c.name}}</h4>
                                <p>{{c.phone}} ‚Ä¢ {{c.meal_balance}} Left</p>
                            </div>
                        </div>
                        <span class="arrow">‚Ä∫</span>
                    </a>
                    {% endfor %}
                </div>
            </div>

        </div>
    </main>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const searchInput = document.getElementById('subscriberSearch');
        const userRows = document.querySelectorAll('.user-row');
        const tierCards = document.querySelectorAll('.tier-card');

        searchInput.addEventListener('input', function() {
            const query = this.value.toLowerCase().trim();

            // 1. First, show/hide individual rows
            userRows.forEach(row => {
                const rowText = row.textContent.toLowerCase();
                if (rowText.includes(query)) {
                    row.style.display = 'flex';
                } else {
                    row.style.display = 'none';
                }
            });

            // 2. Then, handle the card fading (Normal 60, Flagship, etc.)
            tierCards.forEach(card => {
                // Find all rows inside THIS specific card
                const rowsInThisCard = card.querySelectorAll('.user-row');
                
                // Check if at least one row in this card is visible
                const hasVisibleResults = Array.from(rowsInThisCard).some(row => 
                    row.style.display !== 'none'
                );

                // If we are searching (query not empty) AND no results match in this card
                if (query !== "" && !hasVisibleResults) {
                    card.style.opacity = '0.15'; // Fade out
                    card.style.pointerEvents = 'none'; // Optional: disable clicks on faded cards
                    card.style.filter = 'grayscale(1)'; // Optional: extra visual cue
                } else {
                    card.style.opacity = '1'; // Show normally
                    card.style.pointerEvents = 'auto';
                    card.style.filter = 'grayscale(0)';
                }
            });
        });
    });
</script>
</body>

</html>